
function init_moire(){moire.container.push($('.moire_background').attr('src'));moire.container.push($('.moire_overlay').attr('src'));var h1_text=$(".intro_text").children("h1").text().split(" / ");h1_text="<span>"+h1_text[0]+"</span>"+"<span class='slash'>&nbsp;</span>"+"<span>"+h1_text[1]+"</span>";$(".intro_text").children("h1").html(h1_text);if(!is_mobile&&!is_tablet){$.each(moire.container,function(key,val){var objImagePreloader=new Image();objImagePreloader.src=val;if(objImagePreloader.complete){moire_load_callback();objImagePreloader.onload=function(){};}
else{objImagePreloader.onload=function(){moire_load_callback();objImagePreloader.onload=function(){};}}});}}
function moire_load_callback(){moire.load_count++;if(moire.load_count==moire.container.length){var container=$('#moire').eq(0);$("body").on("mousemove",function(event){moire_set_image_position(event);});moire_set_image_classes();moire_set_background_position();moire_set_initial_image_position();$('body').trigger('mousemove',{type:'custom mouse move'});}}
function moire_set_image_position(event){if(setup.window.is_scrolling||setup.window.scrolltop>setup.window.height)return false;var position_x=event.pageX;var position_y=event.pageY;var container=$('#moire').eq(0);var image=$('.moire_overlay').eq(0);var background=$('.moire_background').eq(0);var container_width=$(container).width();var container_height=$(container).height();var container_ratio=container_width/container_height;var image_width=$(image).width();var image_height=$(image).height();var image_ratio=image_width/image_height;if(moire.height>image_height){var image_width=$(image).width();var image_height=$(image).height();var image_ratio=image_width/image_height;}
    var difference_width=image_width-container_width;var difference_height=image_height-container_height;var ratio_x=position_x/container_width;var ratio_y=position_y/container_height;if($(image).hasClass('width')){var margin_left=-1*(ratio_x*difference_width);var margin_top=-1*((ratio_y*difference_width)+(difference_height/2));}else{var margin_left=-1*((ratio_x*difference_height)+(difference_width/2));var margin_top=-1*(ratio_y*difference_height);}
    $(image).css({'margin-left':margin_left,'margin-top':margin_top});}
function moire_set_initial_image_position(){var position_x=setup.window.width/2;var position_y=setup.window.height/2;var container=$('#moire').eq(0);var image=$('.moire_overlay').eq(0);var container_width=$(container).width();var container_height=$(container).height();var image_width=$(image).width();var image_height=$(image).height();var difference_width=image_width-container_width;var difference_height=image_height-container_height;var ratio_x=position_x/container_width;var ratio_y=position_y/container_height;if($(image).hasClass('width')){var margin_left=-1*(ratio_x*difference_width);var margin_top=-1*((ratio_y*difference_width)+(difference_height/2));}else{var margin_left=-1*((ratio_x*difference_height)+(difference_width/2));var margin_top=-1*(ratio_y*difference_height);}
    $(image).css({'margin-left':margin_left,'margin-top':margin_top});}
function moire_set_background_position(){var background=$('.moire_background').eq(0);var container=$('#moire').eq(0);var container_width=$(container).width();var container_height=$(container).height();var image_width=$(background).width();var image_height=$(background).height();var margin_left=-1*(image_width-container_width)/2;var margin_top=-1*(image_height-container_height)/2;$(background).css({'left':margin_left,'top':margin_top});}
function moire_set_image_classes(){var image=$('.moire_overlay').eq(0);var image_height=$(image).height();var image_width=$(image).width();var image_ratio=image_height/image_width;var container=$('#moire').eq(0);var container_height=$(container).height();var container_width=$(container).width();var container_ratio=container_height/container_width;if(container_ratio>image_ratio){$('#moire img').removeClass('width');$('#moire img').addClass('height');}else{$('#moire img').removeClass('height');$('#moire img').addClass('width');}}
function moire_hide(){if(moire.visible){$("#moire").css({visibility:"hidden"});moire.visible=false;}}
function moire_show(){if(!moire.visible){$("#moire").css({visibility:"visible"});moire.visible=true;}}